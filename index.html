<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fedoform ‚Äî AI Social Network</title>
    <style>
        :root { --primary: #0084ff; --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; display: flex; height: 100vh; overflow: hidden; color: var(--text); }

        /* –°–∞–π–¥–±–∞—Ä */
        .sidebar { width: 300px; background: var(--card); border-right: 1px solid #ddd; padding: 25px; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; }
        .logo-box { display: flex; align-items: center; gap: 10px; cursor: pointer; margin-bottom: 10px; }
        .logo-text { font-size: 28px; font-weight: 900; color: var(--primary); letter-spacing: -1.5px; }
        .logo-text span { color: #333; }

        .section-title { font-size: 0.75rem; font-weight: 700; color: #8d949e; text-transform: uppercase; margin-top: 15px; }
        .nav-item { padding: 12px 15px; border-radius: 10px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-weight: 500; position: relative; }
        .nav-item:hover { background: #f2f3f5; }
        .nav-item.active { background: #e7f3ff; color: var(--primary); font-weight: bold; }

        .btn-main { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
        .btn-main:hover { opacity: 0.9; transform: translateY(-1px); }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .main-content { flex-grow: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; align-items: center; }
        .feed { width: 100%; max-width: 580px; }

        /* –ü–æ—Å—Ç—ã */
        .post { background: var(--card); border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid #efefef; }
        .post-header { font-weight: bold; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
        .post-img { width: calc(100% + 40px); margin: 15px -20px; max-height: 400px; object-fit: cover; border-radius: 4px; }
        .comment { background: #f8f9fa; padding: 8px 12px; border-radius: 10px; margin-bottom: 5px; font-size: 0.85rem; border: 1px solid #eee; }
        .comm-author { font-weight: bold; color: var(--primary); font-size: 0.75rem; }

        /* –ü—Ä–æ—Ñ–∏–ª—å –∏ –ß–∞—Ç */
        .profile-card { background: white; border-radius: 20px; padding: 30px; width: 100%; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .profile-avatar { width: 80px; height: 80px; background: #eee; border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; border: 3px solid var(--primary); }
        .stats-row { display: flex; justify-content: center; gap: 20px; margin: 20px 0; padding: 15px; border-top: 1px solid #eee; border-bottom: 1px solid #eee; }
        .badge-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .badge-card { background: #f9f9f9; padding: 10px; border-radius: 10px; opacity: 0.3; filter: grayscale(1); transition: 0.3s; }
        .badge-card.unlocked { opacity: 1; filter: grayscale(0); border: 1px solid gold; background: #fffdf0; }
        
        .chat-window { background: white; border-radius: 20px; width: 100%; height: 500px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .chat-msgs { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; background: #f9f9f9; }
        .msg { max-width: 80%; padding: 10px; border-radius: 12px; font-size: 0.9rem; }
        .msg.ai { align-self: flex-start; background: #e7f3ff; color: #0056b3; }
        .msg.user { align-self: flex-end; background: var(--primary); color: white; }

        /* –°–∏—Å—Ç–µ–º–Ω–æ–µ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-content { background: white; padding: 30px; border-radius: 20px; width: 320px; text-align: center; }
        #ai-bot { position: fixed; bottom: 20px; right: 20px; background: #1a1a1a; color: white; padding: 15px; border-radius: 15px; width: 240px; display: none; border-left: 5px solid var(--primary); z-index: 3000; }
        input[type="text"], textarea { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-family: inherit; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo-box" onclick="showFeed()">
        <svg width="35" height="35" viewBox="0 0 100 100"><rect width="100" height="100" rx="20" fill="#0084ff"/><path d="M35 25H65V35H45V45H60V55H45V75H35V25Z" fill="white"/><circle cx="70" cy="70" r="10" fill="#333" stroke="white" stroke-width="3"/></svg>
        <div class="logo-text">Fedo<span>form</span></div>
    </div>
    
    <div id="authArea"><button class="btn-main" onclick="openAuth()">–í–æ–π—Ç–∏ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button></div>
    <div id="userArea" style="display:none" onclick="showProfile()" style="cursor:pointer">
        <div style="background:#f8f9fa; padding:12px; border-radius:12px; border:1px solid #eee;">
            <div id="uName" style="font-weight:bold; color:var(--primary);">üë§ –ù–∏–∫</div>
            <div id="uBadges" style="font-size:1.1rem; margin-top:5px;"></div>
            <button onclick="event.stopPropagation(); logout()" style="color:red; border:none; background:none; cursor:pointer; font-size:11px; margin-top:5px;">–í—ã—Ö–æ–¥</button>
        </div>
    </div>

    <div class="section-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
    <div class="nav-item" onclick="showFeed()" id="nav-feed">üè† –õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π</div>
    <div class="nav-item" onclick="showChat()" id="nav-chat">ü§ñ –ß–∞—Ç —Å Fedo AI</div>

    <div class="section-title">–†–∞–∑–¥–µ–ª—ã</div>
    <div id="topicsList"></div>
    <button onclick="createTopic()" style="background:none; border:none; color:var(--primary); cursor:pointer; font-weight:600; padding:10px;">+ –ù–æ–≤–∞—è —Ç–µ–º–∞</button>
</div>

<div class="main-content">
    <div class="feed" id="wallCont">
        <div id="editor" style="display:none" class="post">
            <textarea id="postText" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤ —ç—Ç—É —Ç–µ–º—É..." rows="2"></textarea>
            <img id="imgPreview" style="width:100%; display:none; border-radius:10px; margin-top:10px;">
            <div style="display:flex; justify-content:space-between; margin-top:10px;">
                <label style="cursor:pointer; color:var(--primary); font-weight:600;">üì∑ –§–æ—Ç–æ <input type="file" id="fileInp" hidden onchange="prevImg()"></label>
                <button class="btn-main" style="width:auto; padding:5px 20px;" onclick="addPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
        </div>
        <div id="wall"></div>
    </div>
</div>

<div id="authModal" class="modal">
    <div class="modal-content">
        <h2>–í—Ö–æ–¥</h2>
        <input type="text" id="regName" placeholder="–í–∞—à –Ω–∏–∫">
        <div id="aiInp" style="display:none"><input type="text" id="aiCodeInp" placeholder="–ö–æ–¥ –æ—Ç –ò–ò"></div>
        <button class="btn-main" id="authBtn" onclick="askCode()">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
    </div>
</div>

<div id="ai-bot"><strong>ü§ñ Fedo AI:</strong><p id="aiMsg"></p></div>

<script>
    let topics = JSON.parse(localStorage.getItem('ff_topics')) || [{name:'–û–±—â–µ–µ', owner:'–°–∏—Å—Ç–µ–º–∞'}, {name:'–ú–µ–º—ã', owner:'–°–∏—Å—Ç–µ–º–∞'}];
    let posts = JSON.parse(localStorage.getItem('ff_posts')) || [];
    let user = JSON.parse(localStorage.getItem('ff_user')) || null;
    let curTopic = '–û–±—â–µ–µ', currentView = 'feed', curCode = null, tempImg = "";

    const ACHIEVEMENTS = {
        first_post: { name: "–ü–∏—Å–∞—Ç–µ–ª—å", icon: "‚úçÔ∏è", hint: "–ü–µ—Ä–≤—ã–π –ø–æ—Å—Ç" },
        first_comm: { name: "–°–æ–±–µ—Å–µ–¥–Ω–∏–∫", icon: "üí¨", hint: "–ü–µ—Ä–≤—ã–π –∫–æ–º–º–µ–Ω—Ç" },
        liked: { name: "–õ—é–±–∏–º—á–∏–∫", icon: "‚ù§Ô∏è", hint: "–ü–æ–ª—É—á–∏–ª –ª–∞–π–∫" }
    };

    function init() {
        renderTopics(); render();
        if(user) { document.getElementById('authArea').style.display='none'; document.getElementById('userArea').style.display='block'; updateUserUI(); }
    }

    function render() {
        const wall = document.getElementById('wall');
        document.getElementById('editor').style.display = (currentView === 'feed' && user) ? 'block' : 'none';
        if(currentView === 'feed') renderPosts();
        else if(currentView === 'profile') renderProfilePage();
        else if(currentView === 'chat') renderChatPage();
    }

    function showFeed() { currentView = 'feed'; render(); }
    function showProfile() { currentView = 'profile'; render(); }
    function showChat() { currentView = 'chat'; render(); }

    function renderTopics() {
        const l = document.getElementById('topicsList');
        l.innerHTML = topics.map(t => `
            <div class="nav-item ${t.name === curTopic ? 'active' : ''}" onclick="curTopic='${t.name}'; showFeed(); renderTopics();">
                # ${t.name} ${user && t.owner === user.name ? `<button onclick="deleteTopic(event, '${t.name}')" style="background:none; border:none; color:red; margin-left:auto;">√ó</button>` : ''}
            </div>`).join('');
    }

    function createTopic() {
        if(!user) return aiSay("–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ!");
        let n = prompt("–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã:").trim();
        if(n && !topics.find(x => x.name === n)) { topics.push({name: n, owner: user.name}); localStorage.setItem('ff_topics', JSON.stringify(topics)); renderTopics(); }
    }

    function deleteTopic(e, name) {
        e.stopPropagation(); if(confirm("–£–¥–∞–ª–∏—Ç—å —Ç–µ–º—É?")) {
            topics = topics.filter(t => t.name !== name); posts = posts.filter(p => p.topic !== name);
            localStorage.setItem('ff_topics', JSON.stringify(topics)); localStorage.setItem('ff_posts', JSON.stringify(posts));
            curTopic = '–û–±—â–µ–µ'; renderTopics(); renderPosts();
        }
    }

    function renderPosts() {
        const wall = document.getElementById('wall');
        // –ì–õ–ê–í–ù–û–ï: –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ—Å—Ç—ã —Å—Ç—Ä–æ–≥–æ –ø–æ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–µ
        const filtered = posts.filter(p => p.topic === curTopic);
        wall.innerHTML = filtered.length ? filtered.map(p => {
            const isMy = user && p.author === user.name;
            const isL = user && user.likes && user.likes.includes(p.id);
            return `
            <div class="post">
                <div class="post-header">üë§ ${p.author} <span style="font-size:0.7rem; color:gray; margin-left:auto;">#${p.topic}</span></div>
                <div>${p.content}</div>
                ${p.img ? `<img src="${p.img}" class="post-img">`:''}
                <div style="margin-top:10px; display:flex; gap:15px;">
                    <button onclick="like(${p.id})" style="border:none; background:none; cursor:pointer; color:${isL?'red':'#666'}">${isL?'‚ù§Ô∏è':'ü§ç'} ${p.likes}</button>
                    ${isMy ? `<button onclick="delPost(${p.id})" style="border:none; background:none; cursor:pointer; opacity:0.6;">üóëÔ∏è</button>` : ''}
                </div>
                <div style="margin-top:10px; border-top:1px solid #eee; padding-top:10px;">
                    ${(p.comments||[]).map(c=>`<div class="comment"><div class="comm-author">${c.u}</div>${c.t}</div>`).join('')}
                    ${user ? `<div style="display:flex; gap:5px; margin-top:5px;"><input id="ci-${p.id}" placeholder="–û—Ç–≤–µ—Ç–∏—Ç—å..." style="flex-grow:1; font-size:0.8rem; border-radius:15px; border:1px solid #ddd; padding:4px 10px;"><button onclick="addComm(${p.id})" class="btn-main" style="width:auto; padding:2px 8px;">‚ûú</button></div>`:''}
                </div>
            </div>`;
        }).join('') : `<p style="text-align:center; color:gray;">–í —Ç–µ–º–µ #${curTopic} –ø–æ–∫–∞ –ø—É—Å—Ç–æ.</p>`;
    }

    function addPost() {
        let t = document.getElementById('postText').value.trim();
        if(!t && !tempImg) return;
        posts.unshift({ id:Date.now(), author:user.name, topic:curTopic, content:t, img:tempImg, likes:0, comments:[] });
        localStorage.setItem('ff_posts', JSON.stringify(posts));
        document.getElementById('postText').value = ''; document.getElementById('imgPreview').style.display='none'; tempImg = "";
        checkAch('first_post'); renderPosts();
    }

    function like(id) {
        if(!user) return openAuth();
        let p = posts.find(x => x.id === id);
        if(!user.likes) user.likes = [];
        if(user.likes.includes(id)) { p.likes--; user.likes = user.likes.filter(x=>x!==id); }
        else { p.likes++; user.likes.push(id); checkAch('liked'); }
        localStorage.setItem('ff_posts', JSON.stringify(posts)); localStorage.setItem('ff_user', JSON.stringify(user)); renderPosts();
    }

    function addComm(id) {
        let inp = document.getElementById('ci-'+id); if(!inp.value) return;
        posts.find(x => x.id === id).comments.push({u: user.name, t: inp.value});
        localStorage.setItem('ff_posts', JSON.stringify(posts)); checkAch('first_comm'); renderPosts();
    }

    function delPost(id) { if(confirm("–£–¥–∞–ª–∏—Ç—å?")) { posts=posts.filter(x=>x.id!==id); localStorage.setItem('ff_posts', JSON.stringify(posts)); renderPosts(); } }

    function openAuth() { document.getElementById('authModal').style.display='flex'; }
    function closeAuth() { document.getElementById('authModal').style.display='none'; }
    function askCode() {
        let n = document.getElementById('regName').value; if(!n) return;
        curCode = Math.floor(1000 + Math.random()*9000);
        document.getElementById('aiInp').style.display='block'; document.getElementById('authBtn').innerText='–í–æ–π—Ç–∏';
        document.getElementById('authBtn').onclick=confirmAuth; aiSay(`–ö–æ–¥ –¥–ª—è ${n}: ${curCode}`);
    }
    function confirmAuth() {
        if(document.getElementById('aiCodeInp').value == curCode) {
            user = { name: document.getElementById('regName').value, likes: [], achievements: [], email: null };
            localStorage.setItem('ff_user', JSON.stringify(user)); location.reload();
        } else alert("–û—à–∏–±–∫–∞!");
    }
    function logout() { localStorage.removeItem('ff_user'); location.reload(); }

    function renderProfilePage() {
        const wall = document.getElementById('wall');
        const myP = posts.filter(p => p.author === user.name);
        wall.innerHTML = `<div class="profile-card">
            <div class="profile-avatar">üë§</div><h2>${user.name}</h2><p>${user.email || '–ü–æ—á—Ç–∞ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–∞'}</p>
            ${!user.email ? `<button onclick="linkEmail()" class="btn-main" style="width:auto;">–ü—Ä–∏–≤—è–∑–∞—Ç—å –ø–æ—á—Ç—É</button>` : ''}
            <div class="stats-row"><div><b>${myP.length}</b><br>–ü–æ—Å—Ç–æ–≤</div><div><b>${myP.reduce((s,p)=>s+p.likes,0)}</b><br>–õ–∞–π–∫–æ–≤</div></div>
            <div class="badge-grid">${Object.keys(ACHIEVEMENTS).map(k=>`<div class="badge-card ${user.achievements.includes(k)?'unlocked':''}"><div style="font-size:1.5rem;">${ACHIEVEMENTS[k].icon}</div><b>${ACHIEVEMENTS[k].name}</b></div>`).join('')}</div>
        </div>`;
    }

    function linkEmail() {
        let ems = JSON.parse(localStorage.getItem('ff_ems')) || [];
        let e = prompt("Email:").toLowerCase().trim();
        if(e && e.includes('@') && !ems.includes(e)) {
            user.email = e; ems.push(e); localStorage.setItem('ff_user', JSON.stringify(user));
            localStorage.setItem('ff_ems', JSON.stringify(ems)); renderProfilePage(); aiSay("–ü–æ—á—Ç–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞!");
        } else alert("–û—à–∏–±–∫–∞ –∏–ª–∏ –ø–æ—á—Ç–∞ –∑–∞–Ω—è—Ç–∞!");
    }

    function renderChatPage() {
        const wall = document.getElementById('wall');
        wall.innerHTML = `<div class="chat-window"><div class="chat-msgs" id="cl"></div><div style="padding:10px; display:flex; gap:5px;"><input id="aiIn" placeholder="–°–ø—Ä–æ—Å–∏ –±–æ—Ç–∞..."><button onclick="aiChat()" class="btn-main" style="width:auto;">‚ûú</button></div></div>`;
        aiChat("init");
    }

    function aiChat(mode) {
        let cl = document.getElementById('cl');
        if(mode !== "init") {
            let i = document.getElementById('aiIn'); if(!i.value) return;
            cl.innerHTML += `<div class="msg user">${i.value}</div>`; 
            let q = i.value.toLowerCase(); i.value = '';
            setTimeout(() => {
                let a = "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏ –µ—â—ë.";
                if(q.includes("–ø—Ä–∏–≤–µ—Ç")) a = "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —Ç–≤–æ–∏ –¥–µ–ª–∞ –≤ Fedoform?";
                if(q.includes("–∞—á–∏–≤–∫")) a = "–ù–∞–≥—Ä–∞–¥—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª–µ!";
                cl.innerHTML += `<div class="msg ai">${a}</div>`; cl.scrollTop = cl.scrollHeight;
            }, 600);
        } else cl.innerHTML = `<div class="msg ai">–Ø Fedo AI. –ß–µ–º –ø–æ–º–æ—á—å?</div>`;
    }

    function aiSay(m) {
        document.getElementById('ai-bot').style.display='block'; document.getElementById('aiMsg').innerText = m;
        setTimeout(() => document.getElementById('ai-bot').style.display='none', 6000);
    }

    function checkAch(id) {
        if(user && !user.achievements.includes(id)) {
            user.achievements.push(id); localStorage.setItem('ff_user', JSON.stringify(user));
            aiSay(`üèÜ –ù–∞–≥—Ä–∞–¥–∞: ${ACHIEVEMENTS[id].name}!`); updateUserUI();
        }
    }

    function prevImg() {
        let f = document.getElementById('fileInp').files[0];
        let r = new FileReader(); r.onloadend = () => { tempImg = r.result; document.getElementById('imgPreview').src=r.result; document.getElementById('imgPreview').style.display='block'; };
        if(f) r.readAsDataURL(f);
    }

    function updateUserUI() { 
        if(!user) return; 
        document.getElementById('uName').innerText = "üë§ " + user.name;
        document.getElementById('uBadges').innerHTML = (user.achievements||[]).map(a => ACHIEVEMENTS[a].icon).join(' ');
    }

    init();
</script>
</body>
</html>







